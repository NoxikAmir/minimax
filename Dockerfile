# ุงุณุชุฎุฏู ูุณุฎุฉ ุจุงูุซูู 3.11.4
FROM python:3.11.4-slim

# --- ๐ก ุฅุถุงูุฉ ุฌุฏูุฏุฉ: ุชุซุจูุช ffmpeg ---
# ูุฐุง ุงูุฃูุฑ ุถุฑูุฑู ูุนูู ููุชุจุฉ pydub ุจุดูู ุตุญูุญ
RUN apt-get update && apt-get install -y ffmpeg
# --- ููุงูุฉ ุงูุฅุถุงูุฉ ---

# ุชุนููู ูุฌูุฏ ุงูุนูู ุฏุงุฎู ุงูุญุงููุฉ
WORKDIR /app
 
# ูุณุฎ ููู ุงููุชุทูุจุงุช ุฃููุงู ููุงุณุชูุงุฏุฉ ูู ุงูุชุฎุฒูู ุงููุคูุช ูู Docker
COPY requirements.txt .

# ุชุซุจูุช ุงูุญุฒู ุงููุทููุจุฉ
RUN pip install --no-cache-dir -r requirements.txt

# ูุณุฎ ุฌููุน ูููุงุช ุงููุดุฑูุน ุฅูู ูุฌูุฏ ุงูุนูู
COPY . .

# ุงููููุฐ ุงูุฐู ุณูุนูู ุนููู ุชุทุจููู ุฏุงุฎู ุงูุญุงููุฉ (gunicorn)
EXPOSE 8080

# ุงูุฃูุฑ ุงูุฐู ุณูุชู ุชุดุบููู ุนูุฏ ุจุฏุก ุชุดุบูู ุงูุญุงููุฉ
CMD ["gunicorn", "--bind", "0.0.0.0:8080", "--workers", "2", "app:app"]
